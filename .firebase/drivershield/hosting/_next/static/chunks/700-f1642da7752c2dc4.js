"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[700],{9733:function(t,e,r){r.d(e,{d:function(){return u},z:function(){return c}});var n=r(7437),a=r(2265),i=r(1538),o=r(3027),s=r(9354);let u=(0,o.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((t,e)=>{let{className:r,variant:a,size:o,asChild:c=!1,...d}=t,l=c?i.g7:"button";return(0,n.jsx)(l,{className:(0,s.cn)(u({variant:a,size:o,className:r})),ref:e,...d})});c.displayName="Button"},7786:function(t,e,r){r.d(e,{AuthProvider:function(){return p},a:function(){return m}});var n=r(7437),a=r(2265),i=r(9506),o=r(5735),s=r(9842),u=r(2874),c=r(6763),d=r(6463),l=r(8087);let f=(0,a.createContext)(void 0),p=t=>{let{children:e}=t,[r,p]=(0,a.useState)(null),[m,h]=(0,a.useState)(!0),{toast:g}=(0,c.pm)(),y=(0,d.useRouter)();(0,a.useEffect)(()=>{let t=(0,o.Aj)(i.I8,async t=>{if(h(!0),t)try{await new Promise(t=>setTimeout(t,50));let e=await u.GA(t.uid);e?p(e):(console.warn("No Firestore profile found for authenticated user:",t.uid),await (0,o.w7)(i.I8),p(null))}catch(t){console.error("Error fetching user profile:",t),p(null)}else p(null);h(!1)});return()=>t()},[]);let v=async t=>{try{return(await (0,o.e5)(i.I8,t.email,t.password)).user}catch(t){throw console.error("Login failed:",t),g({title:"Prisijungimo klaida",description:t.message||"Patikrinkite el. paštą ir slaptažodį.",variant:"destructive"}),t}},b=async t=>{try{let e=(await (0,o.Xb)(i.I8,t.email,t.password)).user,r={email:t.email,companyName:t.companyName,companyCode:t.companyCode,vatCode:t.vatCode||"",address:t.address,contactPerson:t.contactPerson,phone:t.phone,paymentStatus:"pending_verification",isAdmin:!1,agreeToTerms:t.agreeToTerms,subUsers:[],registeredAt:(0,s.Bt)(),accountActivatedAt:null};await (0,s.pl)((0,s.JU)(i.db,"users",e.uid),r)}catch(t){throw console.error("Signup failed:",t),g({title:"Registracijos klaida",description:t.message||"Nepavyko užregistruoti vartotojo.",variant:"destructive"}),t}},w=async()=>{await (0,o.w7)(i.I8),p(null),y.push("/login")},A=async t=>{if(r)try{await u.Lj(r.id,t);let e={...r,...t};p(e)}catch(t){throw console.error("Failed to update user context and Firestore:",t),g({title:"Atnaujinimo klaida",description:"Nepavyko išsaugoti pakeitimų serveryje.",variant:"destructive"}),t}};return m?(0,n.jsx)("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:(0,n.jsx)(l.Z,{className:"h-12 w-12 animate-spin text-primary"})}):(0,n.jsx)(f.Provider,{value:{user:r,loading:m,login:v,signup:b,logout:w,updateUserInContext:A},children:e})},m=()=>{let t=(0,a.useContext)(f);if(void 0===t)throw Error("useAuth must be used within an AuthProvider");return t}},6763:function(t,e,r){r.d(e,{pm:function(){return f}});var n=r(2265);let a=0,i=new Map,o=t=>{if(i.has(t))return;let e=setTimeout(()=>{i.delete(t),d({type:"REMOVE_TOAST",toastId:t})},1e6);i.set(t,e)},s=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,1)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{let{toastId:r}=e;return r?o(r):t.toasts.forEach(t=>{o(t.id)}),{...t,toasts:t.toasts.map(t=>t.id===r||void 0===r?{...t,open:!1}:t)}}case"REMOVE_TOAST":if(void 0===e.toastId)return{...t,toasts:[]};return{...t,toasts:t.toasts.filter(t=>t.id!==e.toastId)}}},u=[],c={toasts:[]};function d(t){c=s(c,t),u.forEach(t=>{t(c)})}function l(t){let{...e}=t,r=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>d({type:"DISMISS_TOAST",toastId:r});return d({type:"ADD_TOAST",toast:{...e,id:r,open:!0,onOpenChange:t=>{t||n()}}}),{id:r,dismiss:n,update:t=>d({type:"UPDATE_TOAST",toast:{...t,id:r}})}}function f(){let[t,e]=n.useState(c);return n.useEffect(()=>(u.push(e),()=>{let t=u.indexOf(e);t>-1&&u.splice(t,1)}),[t]),{...t,toast:l,dismiss:t=>d({type:"DISMISS_TOAST",toastId:t})}}},9506:function(t,e,r){let n,a;r.d(e,{I8:function(){return d},db:function(){return a},tO:function(){return l}});var i=r(5236),o=r(5735),s=r(9842),u=r(9854);let c="drivercheck";(0,i.C6)().length?(n=(0,i.Mq)(),a=(0,s.ad)(n,c)):(n=(0,i.ZF)({apiKey:"AIzaSyBusklRtrpm-gfnwCdmi2yj5vTumqLte3c",authDomain:"drivershield.firebaseapp.com",projectId:"drivershield",storageBucket:"drivershield.appspot.com",messagingSenderId:"688007961476",appId:"1:688007961476:web:0bf3aa76adba59f7781bd1",measurementId:"G-BKJYEF2X6Y"}),a=(0,s.LV)(n,{experimentalForceLongPolling:!0,localCache:{kind:"memory"}},c));let d=(0,o.v0)(n),l=(0,u.cF)(n)},2874:function(t,e,r){r.d(e,{A5:function(){return p},AW:function(){return u},FA:function(){return y},GA:function(){return d},I1:function(){return l},KO:function(){return v},Lj:function(){return c},cq:function(){return f},hi:function(){return g},oK:function(){return h},tE:function(){return b},w2:function(){return m}});var n=r(9506),a=r(9842),i=r(9854);let o=t=>t&&"function"==typeof t.toDate,s=t=>{let e={...t},r={id:e.id};for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let n=e[t];o(n)?r[t]=n.toDate().toISOString():r[t]=n}return r};async function u(){let t=(0,a.hJ)(n.db,"users");return(await (0,a.PL)(t)).docs.map(t=>s({id:t.id,...t.data()}))}async function c(t,e){let r=(0,a.JU)(n.db,"users",t);await (0,a.r7)(r,e)}async function d(t){let e=(0,a.JU)(n.db,"users",t),r=await (0,a.QT)(e);return r.exists()?s({id:r.id,...r.data()}):null}async function l(){let t=(0,a.hJ)(n.db,"reports"),e=(0,a.IO)(t,(0,a.Xo)("createdAt","desc"));return(await (0,a.PL)(e)).docs.map(t=>s({id:t.id,...t.data()}))}async function f(t){let e=(0,a.hJ)(n.db,"reports"),r={...t,createdAt:(0,a.Bt)(),deletedAt:null};await (0,a.ET)(e,r)}async function p(t){let e=(0,a.JU)(n.db,"reports",t);await (0,a.r7)(e,{deletedAt:(0,a.Bt)()})}async function m(t){let e=(0,a.IO)((0,a.hJ)(n.db,"reports"),(0,a.ar)("reporterId","==",t),(0,a.Xo)("createdAt","desc")),r=(await (0,a.PL)(e)).docs.map(t=>s({id:t.id,...t.data()}));return{active:r.filter(t=>!t.deletedAt),deleted:r.filter(t=>!!t.deletedAt)}}async function h(t){if(!t)return[];let e=(0,a.IO)((0,a.hJ)(n.db,"searchLogs"),(0,a.ar)("userId","==",t),(0,a.Xo)("timestamp","desc"),(0,a.b9)(50));return(await (0,a.PL)(e)).docs.map(t=>s({id:t.id,...t.data()}))}async function g(t){let e={...t,timestamp:(0,a.Bt)()};await (0,a.ET)((0,a.hJ)(n.db,"searchLogs"),e)}async function y(){let t=(0,a.IO)((0,a.hJ)(n.db,"auditLogs"),(0,a.Xo)("timestamp","desc"),(0,a.b9)(100));return(await (0,a.PL)(t)).docs.map(t=>s({id:t.id,...t.data()}))}async function v(t){let e={...t,timestamp:(0,a.Bt)()};await (0,a.ET)((0,a.hJ)(n.db,"auditLogs"),e)}async function b(t){let e="".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9)),r=t.name.split(".").pop(),a=(0,i.iH)(n.tO,"reports/".concat(e,".").concat(r));return await (0,i.KV)(a,t),{url:await (0,i.Jt)(a),dataAiHint:t.name.split(".")[0].replace(/[^a-zA-Z\s]/g,"").substring(0,20)||"document scan"}}}}]);