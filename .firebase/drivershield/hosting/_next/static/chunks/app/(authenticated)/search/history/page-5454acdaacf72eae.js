(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3106,700],{2489:function(e,t,r){Promise.resolve().then(r.bind(r,3507))},7138:function(e,t,r){"use strict";r.d(t,{default:function(){return a.a}});var n=r(231),a=r.n(n)},3507:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var n=r(7437),a=r(2265),s=r(3751),i=r(7786),o=r(2874),l=r(8185),c=r(7304),d=r(9733),u=r(4283),f=r(7835),m=r(4585),p=r(8087),h=r(7138);function y(){let{t:e}=(0,s.Z)(),{user:t}=(0,i.a)(),[r,y]=(0,a.useState)([]),[x,b]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{(async()=>{if(t){b(!0);try{let e=await (0,o.oK)(t.id);y(e)}catch(e){console.error("Error fetching search logs:",e)}finally{b(!1)}}})()},[t]),(0,n.jsx)("div",{className:"space-y-6",children:(0,n.jsxs)(l.Zb,{children:[(0,n.jsxs)(l.Ol,{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(m.Z,{className:"h-8 w-8 text-primary"}),(0,n.jsxs)("div",{children:[(0,n.jsx)(l.ll,{children:e("searchHistory.pageTitle")}),(0,n.jsx)(l.SZ,{children:e("searchHistory.pageDescription")})]})]}),(0,n.jsx)(d.z,{asChild:!0,children:(0,n.jsxs)(h.default,{href:"/search",children:[(0,n.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),e("searchHistory.newSearchButton")]})})]}),(0,n.jsx)(l.aY,{children:x?(0,n.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,n.jsx)(p.Z,{className:"h-12 w-12 animate-spin text-primary"})}):0===r.length?(0,n.jsx)(()=>(0,n.jsxs)("div",{className:"text-center py-16 px-6 border-2 border-dashed rounded-lg mt-6",children:[(0,n.jsx)(u.Z,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,n.jsx)("h3",{className:"mt-4 text-lg font-semibold",children:e("searchHistory.noHistory.title")}),(0,n.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:e("searchHistory.noHistory.message")}),(0,n.jsx)(d.z,{asChild:!0,className:"mt-6",children:(0,n.jsxs)(h.default,{href:"/search",children:[(0,n.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),e("searchHistory.noHistory.performFirstSearchButton")]})})]}),{}):(0,n.jsxs)(l.Zb,{children:[(0,n.jsxs)(l.Ol,{children:[(0,n.jsx)(l.ll,{children:e("searchHistory.table.title")}),(0,n.jsx)(l.SZ,{children:e("searchHistory.table.description")})]}),(0,n.jsx)(l.aY,{children:(0,n.jsxs)(c.iA,{children:[(0,n.jsx)(c.xD,{children:(0,n.jsxs)(c.SC,{children:[(0,n.jsx)(c.ss,{children:e("searchHistory.table.header.query")}),(0,n.jsx)(c.ss,{className:"text-center",children:e("searchHistory.table.header.resultsCount")}),(0,n.jsx)(c.ss,{className:"text-right",children:e("searchHistory.table.header.dateTime")})]})}),(0,n.jsx)(c.RM,{children:r.map(t=>(0,n.jsxs)(c.SC,{children:[(0,n.jsx)(c.pj,{className:"font-medium",children:t.searchText}),(0,n.jsx)(c.pj,{className:"text-center",children:t.resultsCount}),(0,n.jsx)(c.pj,{className:"text-right",children:new Date(t.timestamp).toLocaleString(e("common.localeForDate"))})]},t.id))})]})})]})})]})})}},9733:function(e,t,r){"use strict";r.d(t,{d:function(){return l},z:function(){return c}});var n=r(7437),a=r(2265),s=r(1538),i=r(3027),o=r(9354);let l=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:r,variant:a,size:i,asChild:c=!1,...d}=e,u=c?s.g7:"button";return(0,n.jsx)(u,{className:(0,o.cn)(l({variant:a,size:i,className:r})),ref:t,...d})});c.displayName="Button"},8185:function(e,t,r){"use strict";r.d(t,{Ol:function(){return o},SZ:function(){return c},Zb:function(){return i},aY:function(){return d},eW:function(){return u},ll:function(){return l}});var n=r(7437),a=r(2265),s=r(9354);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});i.displayName="Card";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...a})});o.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("h3",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});l.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("p",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",r),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",r),...a})});d.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",r),...a})});u.displayName="CardFooter"},7304:function(e,t,r){"use strict";r.d(t,{RM:function(){return l},SC:function(){return c},iA:function(){return i},pj:function(){return u},ss:function(){return d},xD:function(){return o}});var n=r(7437),a=r(2265),s=r(9354);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{className:"relative w-full overflow-auto",children:(0,n.jsx)("table",{ref:t,className:(0,s.cn)("w-full caption-bottom text-sm",r),...a})})});i.displayName="Table";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("thead",{ref:t,className:(0,s.cn)("[&_tr]:border-b",r),...a})});o.displayName="TableHeader";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("tbody",{ref:t,className:(0,s.cn)("[&_tr:last-child]:border-0",r),...a})});l.displayName="TableBody",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("tfoot",{ref:t,className:(0,s.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...a})}).displayName="TableFooter";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("tr",{ref:t,className:(0,s.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...a})});c.displayName="TableRow";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("th",{ref:t,className:(0,s.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...a})});d.displayName="TableHead";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("td",{ref:t,className:(0,s.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...a})});u.displayName="TableCell",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("caption",{ref:t,className:(0,s.cn)("mt-4 text-sm text-muted-foreground",r),...a})}).displayName="TableCaption"},7786:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return m},a:function(){return p}});var n=r(7437),a=r(2265),s=r(9506),i=r(5735),o=r(9842),l=r(2874),c=r(6763),d=r(6463),u=r(8087);let f=(0,a.createContext)(void 0),m=e=>{let{children:t}=e,[r,m]=(0,a.useState)(null),[p,h]=(0,a.useState)(!0),{toast:y}=(0,c.pm)(),x=(0,d.useRouter)();(0,a.useEffect)(()=>{let e=(0,i.Aj)(s.I8,async e=>{if(h(!0),e)try{await new Promise(e=>setTimeout(e,50));let t=await l.GA(e.uid);t?m(t):(console.warn("No Firestore profile found for authenticated user:",e.uid),await (0,i.w7)(s.I8),m(null))}catch(e){console.error("Error fetching user profile:",e),m(null)}else m(null);h(!1)});return()=>e()},[]);let b=async e=>{try{return(await (0,i.e5)(s.I8,e.email,e.password)).user}catch(e){throw console.error("Login failed:",e),y({title:"Prisijungimo klaida",description:e.message||"Patikrinkite el. paštą ir slaptažodį.",variant:"destructive"}),e}},g=async e=>{try{let t=(await (0,i.Xb)(s.I8,e.email,e.password)).user,r={email:e.email,companyName:e.companyName,companyCode:e.companyCode,vatCode:e.vatCode||"",address:e.address,contactPerson:e.contactPerson,phone:e.phone,paymentStatus:"pending_verification",isAdmin:!1,agreeToTerms:e.agreeToTerms,subUsers:[],registeredAt:(0,o.Bt)(),accountActivatedAt:null};await (0,o.pl)((0,o.JU)(s.db,"users",t.uid),r)}catch(e){throw console.error("Signup failed:",e),y({title:"Registracijos klaida",description:e.message||"Nepavyko užregistruoti vartotojo.",variant:"destructive"}),e}},j=async()=>{await (0,i.w7)(s.I8),m(null),x.push("/login")},v=async e=>{if(r)try{await l.Lj(r.id,e);let t={...r,...e};m(t)}catch(e){throw console.error("Failed to update user context and Firestore:",e),y({title:"Atnaujinimo klaida",description:"Nepavyko išsaugoti pakeitimų serveryje.",variant:"destructive"}),e}};return p?(0,n.jsx)("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:(0,n.jsx)(u.Z,{className:"h-12 w-12 animate-spin text-primary"})}):(0,n.jsx)(f.Provider,{value:{user:r,loading:p,login:b,signup:g,logout:j,updateUserInContext:v},children:t})},p=()=>{let e=(0,a.useContext)(f);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6763:function(e,t,r){"use strict";r.d(t,{pm:function(){return f}});var n=r(2265);let a=0,s=new Map,i=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?i(r):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],c={toasts:[]};function d(e){c=o(c,e),l.forEach(e=>{e(c)})}function u(e){let{...t}=e,r=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>d({type:"DISMISS_TOAST",toastId:r});return d({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||n()}}}),{id:r,dismiss:n,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=n.useState(c);return n.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},9506:function(e,t,r){"use strict";let n,a;r.d(t,{I8:function(){return d},db:function(){return a},tO:function(){return u}});var s=r(5236),i=r(5735),o=r(9842),l=r(9854);let c="drivercheck";(0,s.C6)().length?(n=(0,s.Mq)(),a=(0,o.ad)(n,c)):(n=(0,s.ZF)({apiKey:"AIzaSyBusklRtrpm-gfnwCdmi2yj5vTumqLte3c",authDomain:"drivershield.firebaseapp.com",projectId:"drivershield",storageBucket:"drivershield.appspot.com",messagingSenderId:"688007961476",appId:"1:688007961476:web:0bf3aa76adba59f7781bd1",measurementId:"G-BKJYEF2X6Y"}),a=(0,o.LV)(n,{experimentalForceLongPolling:!0,localCache:{kind:"memory"}},c));let d=(0,i.v0)(n),u=(0,l.cF)(n)},2874:function(e,t,r){"use strict";r.d(t,{A5:function(){return m},AW:function(){return l},FA:function(){return x},GA:function(){return d},I1:function(){return u},KO:function(){return b},Lj:function(){return c},cq:function(){return f},hi:function(){return y},oK:function(){return h},tE:function(){return g},w2:function(){return p}});var n=r(9506),a=r(9842),s=r(9854);let i=e=>e&&"function"==typeof e.toDate,o=e=>{let t={...e},r={id:t.id};for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e)){let n=t[e];i(n)?r[e]=n.toDate().toISOString():r[e]=n}return r};async function l(){let e=(0,a.hJ)(n.db,"users");return(await (0,a.PL)(e)).docs.map(e=>o({id:e.id,...e.data()}))}async function c(e,t){let r=(0,a.JU)(n.db,"users",e);await (0,a.r7)(r,t)}async function d(e){let t=(0,a.JU)(n.db,"users",e),r=await (0,a.QT)(t);return r.exists()?o({id:r.id,...r.data()}):null}async function u(){let e=(0,a.hJ)(n.db,"reports"),t=(0,a.IO)(e,(0,a.Xo)("createdAt","desc"));return(await (0,a.PL)(t)).docs.map(e=>o({id:e.id,...e.data()}))}async function f(e){let t=(0,a.hJ)(n.db,"reports"),r={...e,createdAt:(0,a.Bt)(),deletedAt:null};await (0,a.ET)(t,r)}async function m(e){let t=(0,a.JU)(n.db,"reports",e);await (0,a.r7)(t,{deletedAt:(0,a.Bt)()})}async function p(e){let t=(0,a.IO)((0,a.hJ)(n.db,"reports"),(0,a.ar)("reporterId","==",e),(0,a.Xo)("createdAt","desc")),r=(await (0,a.PL)(t)).docs.map(e=>o({id:e.id,...e.data()}));return{active:r.filter(e=>!e.deletedAt),deleted:r.filter(e=>!!e.deletedAt)}}async function h(e){if(!e)return[];let t=(0,a.IO)((0,a.hJ)(n.db,"searchLogs"),(0,a.ar)("userId","==",e),(0,a.Xo)("timestamp","desc"),(0,a.b9)(50));return(await (0,a.PL)(t)).docs.map(e=>o({id:e.id,...e.data()}))}async function y(e){let t={...e,timestamp:(0,a.Bt)()};await (0,a.ET)((0,a.hJ)(n.db,"searchLogs"),t)}async function x(){let e=(0,a.IO)((0,a.hJ)(n.db,"auditLogs"),(0,a.Xo)("timestamp","desc"),(0,a.b9)(100));return(await (0,a.PL)(e)).docs.map(e=>o({id:e.id,...e.data()}))}async function b(e){let t={...e,timestamp:(0,a.Bt)()};await (0,a.ET)((0,a.hJ)(n.db,"auditLogs"),t)}async function g(e){let t="".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9)),r=e.name.split(".").pop(),a=(0,s.iH)(n.tO,"reports/".concat(t,".").concat(r));return await (0,s.KV)(a,e),{url:await (0,s.Jt)(a),dataAiHint:e.name.split(".")[0].replace(/[^a-zA-Z\s]/g,"").substring(0,20)||"document scan"}}},1538:function(e,t,r){"use strict";r.d(t,{Z8:function(){return d},g7:function(){return u}});var n,a=r(2265),s=r(1584),i=r(7437),o=Symbol.for("react.lazy"),l=(n||(n=r.t(a,2)))[" use ".trim().toString()];function c(e){var t;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===o&&"_payload"in e&&"object"==typeof(t=e._payload)&&null!==t&&"then"in t}function d(e){let t=function(e){let t=a.forwardRef((e,t)=>{let{children:r,...n}=e;if(c(r)&&"function"==typeof l&&(r=l(r._payload)),a.isValidElement(r)){var i;let e,o;let l=(i=r,(e=Object.getOwnPropertyDescriptor(i.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?i.ref:(e=Object.getOwnPropertyDescriptor(i,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?i.props.ref:i.props.ref||i.ref),c=function(e,t){let r={...t};for(let n in t){let a=e[n],s=t[n];/^on[A-Z]/.test(n)?a&&s?r[n]=(...e)=>{let t=s(...e);return a(...e),t}:a&&(r[n]=a):"style"===n?r[n]={...a,...s}:"className"===n&&(r[n]=[a,s].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props);return r.type!==a.Fragment&&(c.ref=t?(0,s.F)(t,l):l),a.cloneElement(r,c)}return a.Children.count(r)>1?a.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),r=a.forwardRef((e,r)=>{let{children:n,...s}=e;c(n)&&"function"==typeof l&&(n=l(n._payload));let o=a.Children.toArray(n),d=o.find(m);if(d){let e=d.props.children,n=o.map(t=>t!==d?t:a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null);return(0,i.jsx)(t,{...s,ref:r,children:a.isValidElement(e)?a.cloneElement(e,void 0,n):null})}return(0,i.jsx)(t,{...s,ref:r,children:n})});return r.displayName=`${e}.Slot`,r}var u=d("Slot"),f=Symbol("radix.slottable");function m(e){return a.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===f}},4283:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(6497).Z)("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]])},4585:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(6497).Z)("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]])},7835:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(6497).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])}},function(e){e.O(0,[4358,139,6900,4623,231,9354,3751,2971,7023,1744],function(){return e(e.s=2489)}),_N_E=e.O()}]);