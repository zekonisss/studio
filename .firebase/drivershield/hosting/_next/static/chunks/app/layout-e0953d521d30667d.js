(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{1599:function(e,t,r){Promise.resolve().then(r.bind(r,9512)),Promise.resolve().then(r.t.bind(r,8494,23)),Promise.resolve().then(r.t.bind(r,3960,23)),Promise.resolve().then(r.t.bind(r,3054,23)),Promise.resolve().then(r.bind(r,771)),Promise.resolve().then(r.bind(r,3751)),Promise.resolve().then(r.bind(r,7786))},771:function(e,t,r){"use strict";r.d(t,{Toaster:function(){return g}});var a=r(7437),n=r(6763),s=r(2265),i=r(4504),o=r(3027),d=r(4732),u=r(9354);let c=i.zt,l=s.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(i.l_,{ref:t,className:(0,u.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",r),...n})});l.displayName=i.l_.displayName;let f=(0,o.j)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),p=s.forwardRef((e,t)=>{let{className:r,variant:n,...s}=e;return(0,a.jsx)(i.fC,{ref:t,className:(0,u.cn)(f({variant:n}),r),...s})});p.displayName=i.fC.displayName,s.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(i.aU,{ref:t,className:(0,u.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",r),...n})}).displayName=i.aU.displayName;let m=s.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(i.x8,{ref:t,className:(0,u.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",r),"toast-close":"",...n,children:(0,a.jsx)(d.Z,{className:"h-4 w-4"})})});m.displayName=i.x8.displayName;let v=s.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(i.Dx,{ref:t,className:(0,u.cn)("text-sm font-semibold",r),...n})});v.displayName=i.Dx.displayName;let h=s.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(i.dk,{ref:t,className:(0,u.cn)("text-sm opacity-90",r),...n})});function g(){let{toasts:e}=(0,n.pm)();return(0,a.jsxs)(c,{children:[e.map(function(e){let{id:t,title:r,description:n,action:s,...i}=e;return(0,a.jsxs)(p,{...i,children:[(0,a.jsxs)("div",{className:"grid gap-1",children:[r&&(0,a.jsx)(v,{children:r}),n&&(0,a.jsx)(h,{children:n})]}),s,(0,a.jsx)(m,{})]},t)}),(0,a.jsx)(l,{})]})}h.displayName=i.dk.displayName},7786:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return p},a:function(){return m}});var a=r(7437),n=r(2265),s=r(9506),i=r(5735),o=r(9842),d=r(2874),u=r(6763),c=r(6463),l=r(8087);let f=(0,n.createContext)(void 0),p=e=>{let{children:t}=e,[r,p]=(0,n.useState)(null),[m,v]=(0,n.useState)(!0),{toast:h}=(0,u.pm)(),g=(0,c.useRouter)();(0,n.useEffect)(()=>{let e=(0,i.Aj)(s.I8,async e=>{if(v(!0),e)try{await new Promise(e=>setTimeout(e,50));let t=await d.GA(e.uid);t?p(t):(console.warn("No Firestore profile found for authenticated user:",e.uid),await (0,i.w7)(s.I8),p(null))}catch(e){console.error("Error fetching user profile:",e),p(null)}else p(null);v(!1)});return()=>e()},[]);let y=async e=>{try{return(await (0,i.e5)(s.I8,e.email,e.password)).user}catch(e){throw console.error("Login failed:",e),h({title:"Prisijungimo klaida",description:e.message||"Patikrinkite el. paštą ir slaptažodį.",variant:"destructive"}),e}},w=async e=>{try{let t=(await (0,i.Xb)(s.I8,e.email,e.password)).user,r={email:e.email,companyName:e.companyName,companyCode:e.companyCode,vatCode:e.vatCode||"",address:e.address,contactPerson:e.contactPerson,phone:e.phone,paymentStatus:"pending_verification",isAdmin:!1,agreeToTerms:e.agreeToTerms,subUsers:[],registeredAt:(0,o.Bt)(),accountActivatedAt:null};await (0,o.pl)((0,o.JU)(s.db,"users",t.uid),r)}catch(e){throw console.error("Signup failed:",e),h({title:"Registracijos klaida",description:e.message||"Nepavyko užregistruoti vartotojo.",variant:"destructive"}),e}},b=async()=>{await (0,i.w7)(s.I8),p(null),g.push("/login")},x=async e=>{if(r)try{await d.Lj(r.id,e);let t={...r,...e};p(t)}catch(e){throw console.error("Failed to update user context and Firestore:",e),h({title:"Atnaujinimo klaida",description:"Nepavyko išsaugoti pakeitimų serveryje.",variant:"destructive"}),e}};return m?(0,a.jsx)("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:(0,a.jsx)(l.Z,{className:"h-12 w-12 animate-spin text-primary"})}):(0,a.jsx)(f.Provider,{value:{user:r,loading:m,login:y,signup:w,logout:b,updateUserInContext:x},children:t})},m=()=>{let e=(0,n.useContext)(f);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6763:function(e,t,r){"use strict";r.d(t,{pm:function(){return f}});var a=r(2265);let n=0,s=new Map,i=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?i(r):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],u={toasts:[]};function c(e){u=o(u,e),d.forEach(e=>{e(u)})}function l(e){let{...t}=e,r=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),{id:r,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=a.useState(u);return a.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:l,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9506:function(e,t,r){"use strict";let a,n;r.d(t,{I8:function(){return c},db:function(){return n},tO:function(){return l}});var s=r(5236),i=r(5735),o=r(9842),d=r(9854);let u="drivercheck";(0,s.C6)().length?(a=(0,s.Mq)(),n=(0,o.ad)(a,u)):(a=(0,s.ZF)({apiKey:"AIzaSyBusklRtrpm-gfnwCdmi2yj5vTumqLte3c",authDomain:"drivershield.firebaseapp.com",projectId:"drivershield",storageBucket:"drivershield.appspot.com",messagingSenderId:"688007961476",appId:"1:688007961476:web:0bf3aa76adba59f7781bd1",measurementId:"G-BKJYEF2X6Y"}),n=(0,o.LV)(a,{experimentalForceLongPolling:!0,localCache:{kind:"memory"}},u));let c=(0,i.v0)(a),l=(0,d.cF)(a)},2874:function(e,t,r){"use strict";r.d(t,{A5:function(){return p},AW:function(){return d},FA:function(){return g},GA:function(){return c},I1:function(){return l},KO:function(){return y},Lj:function(){return u},cq:function(){return f},hi:function(){return h},oK:function(){return v},tE:function(){return w},w2:function(){return m}});var a=r(9506),n=r(9842),s=r(9854);let i=e=>e&&"function"==typeof e.toDate,o=e=>{let t={...e},r={id:t.id};for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e)){let a=t[e];i(a)?r[e]=a.toDate().toISOString():r[e]=a}return r};async function d(){let e=(0,n.hJ)(a.db,"users");return(await (0,n.PL)(e)).docs.map(e=>o({id:e.id,...e.data()}))}async function u(e,t){let r=(0,n.JU)(a.db,"users",e);await (0,n.r7)(r,t)}async function c(e){let t=(0,n.JU)(a.db,"users",e),r=await (0,n.QT)(t);return r.exists()?o({id:r.id,...r.data()}):null}async function l(){let e=(0,n.hJ)(a.db,"reports"),t=(0,n.IO)(e,(0,n.Xo)("createdAt","desc"));return(await (0,n.PL)(t)).docs.map(e=>o({id:e.id,...e.data()}))}async function f(e){let t=(0,n.hJ)(a.db,"reports"),r={...e,createdAt:(0,n.Bt)(),deletedAt:null};await (0,n.ET)(t,r)}async function p(e){let t=(0,n.JU)(a.db,"reports",e);await (0,n.r7)(t,{deletedAt:(0,n.Bt)()})}async function m(e){let t=(0,n.IO)((0,n.hJ)(a.db,"reports"),(0,n.ar)("reporterId","==",e),(0,n.Xo)("createdAt","desc")),r=(await (0,n.PL)(t)).docs.map(e=>o({id:e.id,...e.data()}));return{active:r.filter(e=>!e.deletedAt),deleted:r.filter(e=>!!e.deletedAt)}}async function v(e){if(!e)return[];let t=(0,n.IO)((0,n.hJ)(a.db,"searchLogs"),(0,n.ar)("userId","==",e),(0,n.Xo)("timestamp","desc"),(0,n.b9)(50));return(await (0,n.PL)(t)).docs.map(e=>o({id:e.id,...e.data()}))}async function h(e){let t={...e,timestamp:(0,n.Bt)()};await (0,n.ET)((0,n.hJ)(a.db,"searchLogs"),t)}async function g(){let e=(0,n.IO)((0,n.hJ)(a.db,"auditLogs"),(0,n.Xo)("timestamp","desc"),(0,n.b9)(100));return(await (0,n.PL)(e)).docs.map(e=>o({id:e.id,...e.data()}))}async function y(e){let t={...e,timestamp:(0,n.Bt)()};await (0,n.ET)((0,n.hJ)(a.db,"auditLogs"),t)}async function w(e){let t="".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9)),r=e.name.split(".").pop(),n=(0,s.iH)(a.tO,"reports/".concat(t,".").concat(r));return await (0,s.KV)(n,e),{url:await (0,s.Jt)(n),dataAiHint:e.name.split(".")[0].replace(/[^a-zA-Z\s]/g,"").substring(0,20)||"document scan"}}},3054:function(){}},function(e){e.O(0,[4817,4358,139,6900,4623,1490,1542,4577,9354,3751,2971,7023,1744],function(){return e(e.s=1599)}),_N_E=e.O()}]);