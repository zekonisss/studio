(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2308,700],{4700:function(e,t,r){Promise.resolve().then(r.bind(r,5148))},7138:function(e,t,r){"use strict";r.d(t,{default:function(){return i.a}});var n=r(231),i=r.n(n)},5148:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var n=r(7437),i=r(9343),a=r(1014),s=r(9733),o=r(8185),l=r(3363),d=r(7209),c=r(9162),u=r(7786),m=r(7138),f=r(3751),p=r(8087),g=r(2265),b=r(6763),h=r(6463);function x(){let{login:e,user:t,loading:r}=(0,u.a)(),{t:x}=(0,f.Z)(),{toast:y}=(0,b.pm)(),v=(0,h.useRouter)(),[w,j]=(0,g.useState)(!1),N=(0,i.cI)({resolver:(0,a.F)(c.pj),defaultValues:{email:"",password:""}});(0,g.useEffect)(()=>{!r&&t&&("active"===t.paymentStatus?v.replace("/dashboard"):v.replace("/activation-pending"))},[t,r,v]);let I=async t=>{j(!0);try{await e(t),y({title:x("toast.login.success.title"),description:x("toast.login.success.description")})}catch(e){console.error("Login error:",e),y({variant:"destructive",title:x("toast.login.error.title"),description:"auth/invalid-credential"===e.code?x("toast.login.error.invalidCredentials"):e.message||x("toast.login.error.descriptionGeneric")})}finally{j(!1)}};return r||!r&&t?(0,n.jsx)("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:(0,n.jsx)(p.Z,{className:"h-12 w-12 animate-spin text-primary"})}):(0,n.jsxs)(o.Zb,{className:"w-full max-w-md",children:[(0,n.jsx)(o.Ol,{children:(0,n.jsx)(o.ll,{className:"text-2xl",children:x("login.title")})}),(0,n.jsxs)(o.aY,{children:[(0,n.jsx)(l.l0,{...N,children:(0,n.jsxs)("form",{onSubmit:N.handleSubmit(I),className:"space-y-4",children:[(0,n.jsx)(l.Wi,{control:N.control,name:"email",render:e=>{let{field:t}=e;return(0,n.jsxs)(l.xJ,{children:[(0,n.jsx)(l.lX,{children:x("login.emailLabel")}),(0,n.jsx)(l.NI,{children:(0,n.jsx)(d.I,{placeholder:"jusu@imone.lt",...t,disabled:w})}),(0,n.jsx)(l.zG,{})]})}}),(0,n.jsx)(l.Wi,{control:N.control,name:"password",render:e=>{let{field:t}=e;return(0,n.jsxs)(l.xJ,{children:[(0,n.jsx)(l.lX,{children:x("login.passwordLabel")}),(0,n.jsx)(l.NI,{children:(0,n.jsx)(d.I,{type:"password",...t,disabled:w})}),(0,n.jsx)(l.zG,{})]})}}),(0,n.jsxs)(s.z,{type:"submit",className:"w-full",disabled:w,children:[w&&(0,n.jsx)(p.Z,{className:"mr-2 h-4 w-4 animate-spin"}),x("login.loginButton")]})]})}),(0,n.jsxs)("div",{className:"mt-4 text-center text-sm",children:[x("login.noAccount")," ",(0,n.jsx)(m.default,{href:"/signup",className:"underline",children:x("login.signupLink")})]}),(0,n.jsx)("div",{className:"mt-2 text-center text-sm",children:(0,n.jsx)(m.default,{href:"/forgot-password",className:"underline text-xs text-muted-foreground",children:x("login.forgotPasswordLink")})})]})]})}},9733:function(e,t,r){"use strict";r.d(t,{d:function(){return l},z:function(){return d}});var n=r(7437),i=r(2265),a=r(1538),s=r(3027),o=r(9354);let l=(0,s.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=i.forwardRef((e,t)=>{let{className:r,variant:i,size:s,asChild:d=!1,...c}=e,u=d?a.g7:"button";return(0,n.jsx)(u,{className:(0,o.cn)(l({variant:i,size:s,className:r})),ref:t,...c})});d.displayName="Button"},8185:function(e,t,r){"use strict";r.d(t,{Ol:function(){return o},SZ:function(){return d},Zb:function(){return s},aY:function(){return c},eW:function(){return u},ll:function(){return l}});var n=r(7437),i=r(2265),a=r(9354);let s=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...i})});s.displayName="Card";let o=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...i})});o.displayName="CardHeader";let l=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,n.jsx)("h3",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",r),...i})});l.displayName="CardTitle";let d=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,n.jsx)("p",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...i})});d.displayName="CardDescription";let c=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",r),...i})});c.displayName="CardContent";let u=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r),...i})});u.displayName="CardFooter"},3363:function(e,t,r){"use strict";r.d(t,{NI:function(){return b},Wi:function(){return u},l0:function(){return d},lX:function(){return g},pf:function(){return h},xJ:function(){return p},zG:function(){return x}});var n=r(7437),i=r(2265),a=r(1538),s=r(9343),o=r(9354),l=r(402);let d=s.RV,c=i.createContext({}),u=e=>{let{...t}=e;return(0,n.jsx)(c.Provider,{value:{name:t.name},children:(0,n.jsx)(s.Qr,{...t})})},m=()=>{let e=i.useContext(c),t=i.useContext(f),{getFieldState:r,formState:n}=(0,s.Gc)(),a=r(e.name,n);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=t;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...a}},f=i.createContext({}),p=i.forwardRef((e,t)=>{let{className:r,...a}=e,s=i.useId();return(0,n.jsx)(f.Provider,{value:{id:s},children:(0,n.jsx)("div",{ref:t,className:(0,o.cn)("space-y-2",r),...a})})});p.displayName="FormItem";let g=i.forwardRef((e,t)=>{let{className:r,...i}=e,{error:a,formItemId:s}=m();return(0,n.jsx)(l._,{ref:t,className:(0,o.cn)(a&&"text-destructive",r),htmlFor:s,...i})});g.displayName="FormLabel";let b=i.forwardRef((e,t)=>{let{...r}=e,{error:i,formItemId:s,formDescriptionId:o,formMessageId:l}=m();return(0,n.jsx)(a.g7,{ref:t,id:s,"aria-describedby":i?"".concat(o," ").concat(l):"".concat(o),"aria-invalid":!!i,...r})});b.displayName="FormControl";let h=i.forwardRef((e,t)=>{let{className:r,...i}=e,{formDescriptionId:a}=m();return(0,n.jsx)("p",{ref:t,id:a,className:(0,o.cn)("text-sm text-muted-foreground",r),...i})});h.displayName="FormDescription";let x=i.forwardRef((e,t)=>{var r;let{className:i,children:a,...s}=e,{error:l,formMessageId:d}=m(),c=l?String(null!==(r=null==l?void 0:l.message)&&void 0!==r?r:""):a;return c?(0,n.jsx)("p",{ref:t,id:d,className:(0,o.cn)("text-sm font-medium text-destructive",i),...s,children:c}):null});x.displayName="FormMessage"},7209:function(e,t,r){"use strict";r.d(t,{I:function(){return s}});var n=r(7437),i=r(2265),a=r(9354);let s=i.forwardRef((e,t)=>{let{className:r,type:i,...s}=e;return(0,n.jsx)("input",{type:i,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...s})});s.displayName="Input"},402:function(e,t,r){"use strict";r.d(t,{_:function(){return d}});var n=r(7437),i=r(2265),a=r(8837),s=r(3027),o=r(9354);let l=(0,s.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,n.jsx)(a.f,{ref:t,className:(0,o.cn)(l(),r),...i})});d.displayName=a.f.displayName},7786:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return f},a:function(){return p}});var n=r(7437),i=r(2265),a=r(9506),s=r(5735),o=r(9842),l=r(2874),d=r(6763),c=r(6463),u=r(8087);let m=(0,i.createContext)(void 0),f=e=>{let{children:t}=e,[r,f]=(0,i.useState)(null),[p,g]=(0,i.useState)(!0),{toast:b}=(0,d.pm)(),h=(0,c.useRouter)();(0,i.useEffect)(()=>{let e=(0,s.Aj)(a.I8,async e=>{if(g(!0),e)try{await new Promise(e=>setTimeout(e,50));let t=await l.GA(e.uid);t?f(t):(console.warn("No Firestore profile found for authenticated user:",e.uid),await (0,s.w7)(a.I8),f(null))}catch(e){console.error("Error fetching user profile:",e),f(null)}else f(null);g(!1)});return()=>e()},[]);let x=async e=>{try{return(await (0,s.e5)(a.I8,e.email,e.password)).user}catch(e){throw console.error("Login failed:",e),b({title:"Prisijungimo klaida",description:e.message||"Patikrinkite el. paštą ir slaptažodį.",variant:"destructive"}),e}},y=async e=>{try{let t=(await (0,s.Xb)(a.I8,e.email,e.password)).user,r={email:e.email,companyName:e.companyName,companyCode:e.companyCode,vatCode:e.vatCode||"",address:e.address,contactPerson:e.contactPerson,phone:e.phone,paymentStatus:"pending_verification",isAdmin:!1,agreeToTerms:e.agreeToTerms,subUsers:[],registeredAt:(0,o.Bt)(),accountActivatedAt:null};await (0,o.pl)((0,o.JU)(a.db,"users",t.uid),r)}catch(e){throw console.error("Signup failed:",e),b({title:"Registracijos klaida",description:e.message||"Nepavyko užregistruoti vartotojo.",variant:"destructive"}),e}},v=async()=>{await (0,s.w7)(a.I8),f(null),h.push("/login")},w=async e=>{if(r)try{await l.Lj(r.id,e);let t={...r,...e};f(t)}catch(e){throw console.error("Failed to update user context and Firestore:",e),b({title:"Atnaujinimo klaida",description:"Nepavyko išsaugoti pakeitimų serveryje.",variant:"destructive"}),e}};return p?(0,n.jsx)("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:(0,n.jsx)(u.Z,{className:"h-12 w-12 animate-spin text-primary"})}):(0,n.jsx)(m.Provider,{value:{user:r,loading:p,login:x,signup:y,logout:v,updateUserInContext:w},children:t})},p=()=>{let e=(0,i.useContext)(m);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6763:function(e,t,r){"use strict";r.d(t,{pm:function(){return m}});var n=r(2265);let i=0,a=new Map,s=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);a.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?s(r):e.toasts.forEach(e=>{s(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=o(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,r=(i=(i+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||n()}}}),{id:r,dismiss:n,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function m(){let[e,t]=n.useState(d);return n.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9506:function(e,t,r){"use strict";let n,i;r.d(t,{I8:function(){return c},db:function(){return i},tO:function(){return u}});var a=r(5236),s=r(5735),o=r(9842),l=r(9854);let d="drivercheck";(0,a.C6)().length?(n=(0,a.Mq)(),i=(0,o.ad)(n,d)):(n=(0,a.ZF)({apiKey:"AIzaSyBusklRtrpm-gfnwCdmi2yj5vTumqLte3c",authDomain:"drivershield.firebaseapp.com",projectId:"drivershield",storageBucket:"drivershield.appspot.com",messagingSenderId:"688007961476",appId:"1:688007961476:web:0bf3aa76adba59f7781bd1",measurementId:"G-BKJYEF2X6Y"}),i=(0,o.LV)(n,{experimentalForceLongPolling:!0,localCache:{kind:"memory"}},d));let c=(0,s.v0)(n),u=(0,l.cF)(n)},9162:function(e,t,r){"use strict";r.d(t,{Hi:function(){return o},ZO:function(){return s},fb:function(){return i},pj:function(){return a}});var n=r(537);let i=n.Ry({email:n.Z_().email({message:"Neteisingas el. pašto formatas."}),password:n.Z_().min(8,{message:"Slaptažodis turi būti bent 8 simbolių ilgio."}),confirmPassword:n.Z_().min(8,{message:"Slaptažodis turi būti bent 8 simbolių ilgio."}),companyName:n.Z_().min(2,{message:"Įmonės pavadinimas turi būti bent 2 simbolių ilgio."}),companyCode:n.Z_().regex(/^\d{9}$/,{message:"Įmonės kodas turi būti 9 skaitmenys."}),vatCode:n.Z_().optional(),address:n.Z_().min(5,{message:"Adresas turi būti bent 5 simbolių ilgio."}),contactPerson:n.Z_().min(3,{message:"Kontaktinis asmuo turi būti bent 3 simbolių ilgio."}),phone:n.Z_().regex(/^\+?\d{7,15}$/,{message:"Neteisingas telefono numerio formatas."}),agreeToTerms:n.O7().refine(e=>!0===e,{message:"Privalote sutikti su taisyklėmis."})}).refine(e=>e.password===e.confirmPassword,{message:"Slaptažodžiai nesutampa.",path:["confirmPassword"]}),a=n.Ry({email:n.Z_().email({message:"Neteisingas el. pašto formatas."}),password:n.Z_().min(1,{message:"Slaptažodis yra privalomas."})}),s=n.Ry({fullName:n.Z_().min(3,{message:"Vardas ir pavardė turi būti bent 3 simbolių ilgio."}),nationality:n.Z_().optional(),birthYear:n.Rx().int().min(1900).max(new Date().getFullYear()).optional().or(n.i0("")),category:n.Z_().min(1,{message:"Pagrindinė kategorija yra privaloma."}),tags:n.IX(n.Z_()).optional(),comment:n.Z_().min(10,{message:"Komentaras turi būti bent 10 simbolių ilgio."}),image:n.Yj().optional()}),o=n.Ry({query:n.Z_().min(3,{message:"Paieškos frazė turi būti bent 3 simbolių ilgio."})})},2874:function(e,t,r){"use strict";r.d(t,{A5:function(){return f},AW:function(){return l},FA:function(){return h},GA:function(){return c},I1:function(){return u},KO:function(){return x},Lj:function(){return d},cq:function(){return m},hi:function(){return b},oK:function(){return g},tE:function(){return y},w2:function(){return p}});var n=r(9506),i=r(9842),a=r(9854);let s=e=>e&&"function"==typeof e.toDate,o=e=>{let t={...e},r={id:t.id};for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e)){let n=t[e];s(n)?r[e]=n.toDate().toISOString():r[e]=n}return r};async function l(){let e=(0,i.hJ)(n.db,"users");return(await (0,i.PL)(e)).docs.map(e=>o({id:e.id,...e.data()}))}async function d(e,t){let r=(0,i.JU)(n.db,"users",e);await (0,i.r7)(r,t)}async function c(e){let t=(0,i.JU)(n.db,"users",e),r=await (0,i.QT)(t);return r.exists()?o({id:r.id,...r.data()}):null}async function u(){let e=(0,i.hJ)(n.db,"reports"),t=(0,i.IO)(e,(0,i.Xo)("createdAt","desc"));return(await (0,i.PL)(t)).docs.map(e=>o({id:e.id,...e.data()}))}async function m(e){let t=(0,i.hJ)(n.db,"reports"),r={...e,createdAt:(0,i.Bt)(),deletedAt:null};await (0,i.ET)(t,r)}async function f(e){let t=(0,i.JU)(n.db,"reports",e);await (0,i.r7)(t,{deletedAt:(0,i.Bt)()})}async function p(e){let t=(0,i.IO)((0,i.hJ)(n.db,"reports"),(0,i.ar)("reporterId","==",e),(0,i.Xo)("createdAt","desc")),r=(await (0,i.PL)(t)).docs.map(e=>o({id:e.id,...e.data()}));return{active:r.filter(e=>!e.deletedAt),deleted:r.filter(e=>!!e.deletedAt)}}async function g(e){if(!e)return[];let t=(0,i.IO)((0,i.hJ)(n.db,"searchLogs"),(0,i.ar)("userId","==",e),(0,i.Xo)("timestamp","desc"),(0,i.b9)(50));return(await (0,i.PL)(t)).docs.map(e=>o({id:e.id,...e.data()}))}async function b(e){let t={...e,timestamp:(0,i.Bt)()};await (0,i.ET)((0,i.hJ)(n.db,"searchLogs"),t)}async function h(){let e=(0,i.IO)((0,i.hJ)(n.db,"auditLogs"),(0,i.Xo)("timestamp","desc"),(0,i.b9)(100));return(await (0,i.PL)(e)).docs.map(e=>o({id:e.id,...e.data()}))}async function x(e){let t={...e,timestamp:(0,i.Bt)()};await (0,i.ET)((0,i.hJ)(n.db,"auditLogs"),t)}async function y(e){let t="".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9)),r=e.name.split(".").pop(),i=(0,a.iH)(n.tO,"reports/".concat(t,".").concat(r));return await (0,a.KV)(i,e),{url:await (0,a.Jt)(i),dataAiHint:e.name.split(".")[0].replace(/[^a-zA-Z\s]/g,"").substring(0,20)||"document scan"}}}},function(e){e.O(0,[4358,139,6900,4623,231,3318,9354,3751,2971,7023,1744],function(){return e(e.s=4700)}),_N_E=e.O()}]);